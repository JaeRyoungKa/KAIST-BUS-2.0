<!DOCTYPE html>
<html lang="en">

<head>
  <title>KAIST 버스 2.0</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css"
    integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
  <script>

    var array1 = [525, 535, 555, 565, 585, 595, 615, 625, 645, 655, 675, 685, 705, 775, 795, 805, 825, 835, 855, 865, 885, 895, 915, 925, 945, 955, 975, 985, 1005, 1015];
    var delay = [0, 2, 3, 4, 5, 6, 7, 9];

    var date = new Date();

    setInterval(function () {
      date.setSeconds(date.getSeconds() + 1);
      var time = tick(date.getHours(), 2) + ":" + tick(date.getMinutes(), 2) + ":" + tick(date.getSeconds(), 2);
      $('.current_timer').text(time);

      var next_bus_val = next_bus(date.getHours(), date.getMinutes(), 0);
      if (next_bus_val == -1) {
        $("#timer_nextbus").text("운행 종료");
        $("#timer_left").text("운행 종료");
      } else {
        $("#timer_nextbus").text(tick(Math.floor(array1[next_bus_val] / 60), 2) + ":" + tick(Math.floor(array1[next_bus_val] - Math.floor(array1[next_bus_val] / 60) * 60), 2) + ":00");
        var time_left = Math.floor(array1[next_bus_val] / 60) * 3600 + Math.floor(array1[next_bus_val] - Math.floor(array1[next_bus_val] / 60) * 60) * 60 + 0 - (date.getHours() * 3600 + date.getMinutes() * 60 + date.getSeconds());
        $("#timer_left").text(tick(Math.floor(time_left / 3600), 2) + ":" + tick(Math.floor((time_left - Math.floor(time_left / 3600) * 3600) / 60), 2) + ":" + tick(time_left - Math.floor(time_left / 3600) * 3600 - Math.floor((time_left - Math.floor(time_left / 3600) * 3600) / 60) * 60, 2));
      }

      $("#timer_nextbus2").text(stationTimerSetting1(delay[1], date));
      $("#timer_left2").text(stationTimerSetting2(delay[1], date));

      $("#timer_nextbus3").text(stationTimerSetting1(delay[2], date));
      $("#timer_left3").text(stationTimerSetting2(delay[2], date));

      $("#timer_nextbus4").text(stationTimerSetting1(delay[3], date));
      $("#timer_left4").text(stationTimerSetting2(delay[3], date));

      $("#timer_nextbus5").text(stationTimerSetting1(delay[4], date));
      $("#timer_left5").text(stationTimerSetting2(delay[4], date));

      $("#timer_nextbus6").text(stationTimerSetting1(delay[5], date));
      $("#timer_left6").text(stationTimerSetting2(delay[5], date));

      $(".spinner-timer").hide();

    }, 1000)

    function stationTimerSetting1(offset, date) {
      var next_bus_val = next_bus(date.getHours(), date.getMinutes(), offset);
      if (next_bus_val == -1) {
        return "운행 종료";
      } else {
        var next_bus_time = array1[next_bus_val] + offset;
        return tick(Math.floor(next_bus_time / 60), 2) + ":" + tick(Math.floor(next_bus_time - Math.floor(next_bus_time / 60) * 60), 2) + ":00";
      }
    }

    function stationTimerSetting2(offset, date) {
      var next_bus_val = next_bus(date.getHours(), date.getMinutes(), offset);
      if (next_bus_val == -1) {
        return "운행 종료";
      } else {
        var next_bus_time = array1[next_bus_val] + offset;
        var time_left = Math.floor(next_bus_time / 60) * 3600 + Math.floor(next_bus_time - Math.floor(next_bus_time / 60) * 60) * 60 - (date.getHours() * 3600 + date.getMinutes() * 60 + date.getSeconds());
        return tick(Math.floor(time_left / 3600), 2) + ":" + tick(Math.floor((time_left - Math.floor(time_left / 3600) * 3600) / 60), 2) + ":" + tick(time_left - Math.floor(time_left / 3600) * 3600 - Math.floor((time_left - Math.floor(time_left / 3600) * 3600) / 60) * 60, 2);
      }
    }


    function int2str(num) {
      var hr = tick(Math.floor(num / 60), 2);
      var min = tick(num - Math.floor(num / 60) * 60, 2);
      return hr + "시 " + min + "분";
    }

    function tick(num, size) {
      var s = num + "";
      while (s.length < size) s = "0" + s;

      return s;
    }

    function next_bus(hr, min, offset) {
      var cur_time = hr * 60 + min;

      for (var i = 0; i < array1.length; i++) {
        if (array1[i] + offset > cur_time) {
          return i;
        }
      }
      return -1;
    }

    function contentsMaker(offset) {
      var contents = "";
      for (i = 0; i < array1.length; i++) {
        contents += "<tr><td>" + (i + 1) + "</td><td style='text-align: right;'>" + int2str(array1[i] + offset) + "</td></tr>";
      }
      return contents;
    }
    $(document).ready(function () {
      $('[data-toggle="tooltip_noWeekends"]').tooltip();
      $('[data-toggle="tooltip"]').tooltip();

      $('#ttProvider').append(contentsMaker(delay[0]));
      $('#ttProvider2').append(contentsMaker(delay[1]));
      $('#ttProvider3').append(contentsMaker(delay[2]));
      $('#ttProvider4').append(contentsMaker(delay[3]));
      $('#ttProvider5').append(contentsMaker(delay[4]));
      $('#ttProvider6').append(contentsMaker(delay[5]));


    });
  </script>

  <style>
    @media (min-width: 768px) {
      .navbar-brand.abs {
        position: absolute;
        width: 100%;
        left: 0;
        text-align: center;
      }
    }

    * {
      font-size: 0.925rem;
    }

    td {
      font-size: 1rem;
    }

    th {
      font-size: 1rem;
    }

    i {
      font-size: 1.2rem;
    }

    .navbar {
      padding-top: 2px;
      padding-bottom: 2px;
    }

    .border {
      display: inline-block;
      margin: 0px;
      width: 100%;
      border-width: 0px !important;

    }

    body {
      padding-top: 44px;
    }

    a {
      color: black;
    }

    .nav-pills .nav-link.active {
      background-color: #413b98;
      opacity: 0.85;
    }

    .nav-pills .nav-link:not(.active):hover {
      color: #413b98;
      opacity: 0.9;
    }
  </style>
</head>

<body>


  <nav class="navbar navbar-expand-md navbar-dark bg-primary fixed-top" style="background-color:#3e2723 !important; padding-top:6px; padding-bottom:6px;">
    <a class="navbar-brand abs" href="#">카이스트 버스 2.0</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsingNavbar">
      <!-- <span class="navbar-toggler-icon"></span> -->
      <span style="font-size:16px; color:white; opacity: 0.90;">노선 선택</span>
    </button>
    <div class="navbar-collapse collapse" id="collapsingNavbar">
      <ul class="navbar-nav">
        <li class="nav-item active">
          <a class="nav-link" href="#">OLEV <span class="badge badge-warning">New</span></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">시내순환 <span class="badge badge-light">WIP</span> </a>
        </li>
      </ul>
      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <a class="nav-link" href="" data-target="#myModal" data-toggle="modal">Feedback</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="" data-target="#myModal" data-toggle="modal">About</a>
        </li>
      </ul>
    </div>
  </nav>

  <nav class="navbar navbar-dark navbar-expand bg-faded justify-content-center"
    style="background-color:#413b98; opacity: 0.85;">
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsingNavbar3">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="navbar-collapse collapse w-100" id="collapsingNavbar3">
      <ul class="navbar-nav w-100 justify-content-center">
        <li class="nav-item active">
          <a class="nav-link" href="#">OLEV 주중</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#" data-toggle="tooltip_noWeekends" data-placement="right"
            title="운행하지 않습니다.">주말/공휴일</a>
        </li>
      </ul>
    </div>
  </nav>

  <nav class="navbar navbar-light navbar-expand bg-faded justify-content-center"
    style="background-color:#fdd835 !important;">
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsingNavbar3">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="navbar-collapse collapse w-100" id="collapsingNavbar3">
      <ul class="nav nav-pills w-100 justify-content-center" role="tablist">
        <li class="nav-item">
          <a class="nav-link active" data-toggle="tab" href="#tab1">정류장 1</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" data-toggle="tab" href="#tab2">정류장 2</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" data-toggle="tab" href="#tab3">정류장 3</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" data-toggle="tab" href="#tab4">정류장 4</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" data-toggle="tab" href="#tab5">정류장 5</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" data-toggle="tab" href="#tab6">정류장 6</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#"><span data-toggle="tooltip" data-placement="bottom" title="준비중입니다.">정류장 7</span></a>
        </li>
        </li>
      </ul>
    </div>
  </nav>

  <div class="container">
    <div class="tab-content">
      <div id="tab1" class="container tab-pane active">
        <div class="card bg-light text-dark text-center" style="margin-top:18px; margin-bottom:18px;">
          <div class="card-body">
            <div class="container">
              <div class="row" style="font-size:24px;">
                <div class="col-4">
                  <h4 data-toggle="tooltip" data-placement="top" title="현재 시각"><i class="far fa-clock"></i></h4>
                  <div id="timer_placeholder" class="spinner-border text-info spinner-timer"></div>
                  <span class="current_timer" style="margin-bottom:0;"></span>
                </div>
                <div class="col-4">
                  <h4 data-toggle="tooltip" data-placement="top" title="다음 버스 시각"><i class="fas fa-bus"></i></h4>
                  <div id="timer_placeholder2" class="spinner-border text-info spinner-timer"></div>
                  <span id="timer_nextbus" style="margin-bottom:0;"></span>
                </div>
                <div class="col-4" style="color:dodgerblue;">
                  <h4 data-toggle="tooltip" data-placement="top" title="남은 시간"><i class="fas fa-stopwatch"></i></h4>
                  <div id="timer_placeholder3" class="spinner-border text-info spinner-timer"></div>
                  <span id="timer_left" style="margin-bottom:0;"></span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="alert alert-info alert-dismissible">
          <button type="button" class="close" data-dismiss="alert">&times;</button>
          <strong>정보:</strong> 이 시간표는 교통 상황에 따라 부정확할 수 있으며, GPS 등의 장치를 통해 실시간으로 추적되고 있지 않습니다.
        </div>
        <table id="OLEV_normal" class="table table-hover" style="margin-top:12px;">
          <thead>
            <tr>
              <th>회차</th>
              <th style="text-align:right;">시간</th>
            </tr>
          </thead>
          <tbody id='ttProvider'>
          </tbody>
        </table>

      </div>
      <div id="tab2" class="container tab-pane">
        <div class="card bg-light text-dark text-center" style="margin-top:18px; margin-bottom:18px;">
          <div class="card-body">
            <div class="container">
              <div class="row" style="font-size:24px;">
                <div class="col-4">
                  <h4 data-toggle="tooltip" data-placement="top" title="현재 시각"><i class="far fa-clock"></i></h4>
                  <div class="spinner-border text-danger spinner-timer"></div>
                  <span class="current_timer" style="margin-bottom:0;"></span>
                </div>
                <div class="col-4">
                  <h4 data-toggle="tooltip" data-placement="top" title="다음 버스 시각"><i class="fas fa-bus"></i></h4>
                  <div class="spinner-border text-danger spinner-timer"></div>
                  <span id="timer_nextbus2" style="margin-bottom:0;"></span>
                </div>
                <div class="col-4" style="color:dodgerblue;">
                  <h4 data-toggle="tooltip" data-placement="top" title="남은 시간"><i class="fas fa-stopwatch"></i></h4>
                  <div class="spinner-border text-danger spinner-timer"></div>
                  <span id="timer_left2" style="margin-bottom:0;"></span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <table class="table table-hover" style="margin-top:12px;">
          <thead>
            <tr>
              <th>회차</th>
              <th style="text-align:right;">시간</th>
            </tr>
          </thead>
          <tbody id='ttProvider2'>
          </tbody>
        </table>

      </div>
      <div id="tab3" class="container tab-pane">
        <div class="card bg-light text-dark text-center" style="margin-top:18px; margin-bottom:18px;">
          <div class="card-body">
            <div class="container">
              <div class="row" style="font-size:24px;">
                <div class="col-4">
                  <h4 data-toggle="tooltip" data-placement="top" title="현재 시각"><i class="far fa-clock"></i></h4>
                  <div class="spinner-border text-danger spinner-timer"></div>
                  <span class="current_timer" style="margin-bottom:0;"></span>
                </div>
                <div class="col-4">
                  <h4 data-toggle="tooltip" data-placement="top" title="다음 버스 시각"><i class="fas fa-bus"></i></h4>
                  <div class="spinner-border text-danger spinner-timer"></div>
                  <span id="timer_nextbus3" style="margin-bottom:0;"></span>
                </div>
                <div class="col-4" style="color:dodgerblue;">
                  <h4 data-toggle="tooltip" data-placement="top" title="남은 시간"><i class="fas fa-stopwatch"></i></h4>
                  <div class="spinner-border text-danger spinner-timer"></div>
                  <span id="timer_left3" style="margin-bottom:0;"></span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <table class="table table-hover" style="margin-top:12px;">
          <thead>
            <tr>
              <th>회차</th>
              <th style="text-align:right;">시간</th>
            </tr>
          </thead>
          <tbody id='ttProvider3'>
          </tbody>
        </table>
      </div>

      <div id="tab4" class="container tab-pane">
          <div class="card bg-light text-dark text-center" style="margin-top:18px; margin-bottom:18px;">
            <div class="card-body">
              <div class="container">
                <div class="row" style="font-size:24px;">
                  <div class="col-4">
                    <h4 data-toggle="tooltip" data-placement="top" title="현재 시각"><i class="far fa-clock"></i></h4>
                    <div class="spinner-border text-danger spinner-timer"></div>
                    <span class="current_timer" style="margin-bottom:0;"></span>
                  </div>
                  <div class="col-4">
                    <h4 data-toggle="tooltip" data-placement="top" title="다음 버스 시각"><i class="fas fa-bus"></i></h4>
                    <div class="spinner-border text-danger spinner-timer"></div>
                    <span id="timer_nextbus4" style="margin-bottom:0;"></span>
                  </div>
                  <div class="col-4" style="color:dodgerblue;">
                    <h4 data-toggle="tooltip" data-placement="top" title="남은 시간"><i class="fas fa-stopwatch"></i></h4>
                    <div class="spinner-border text-danger spinner-timer"></div>
                    <span id="timer_left4" style="margin-bottom:0;"></span>
                  </div>
                </div>
              </div>
            </div>
          </div>
  
          <table class="table table-hover" style="margin-top:12px;">
            <thead>
              <tr>
                <th>회차</th>
                <th style="text-align:right;">시간</th>
              </tr>
            </thead>
            <tbody id='ttProvider4'>
            </tbody>
          </table>
        </div>

        <div id="tab5" class="container tab-pane">
            <div class="card bg-light text-dark text-center" style="margin-top:18px; margin-bottom:18px;">
              <div class="card-body">
                <div class="container">
                  <div class="row" style="font-size:24px;">
                    <div class="col-4">
                      <h4 data-toggle="tooltip" data-placement="top" title="현재 시각"><i class="far fa-clock"></i></h4>
                      <div class="spinner-border text-danger spinner-timer"></div>
                      <span class="current_timer" style="margin-bottom:0;"></span>
                    </div>
                    <div class="col-4">
                      <h4 data-toggle="tooltip" data-placement="top" title="다음 버스 시각"><i class="fas fa-bus"></i></h4>
                      <div class="spinner-border text-danger spinner-timer"></div>
                      <span id="timer_nextbus5" style="margin-bottom:0;"></span>
                    </div>
                    <div class="col-4" style="color:dodgerblue;">
                      <h4 data-toggle="tooltip" data-placement="top" title="남은 시간"><i class="fas fa-stopwatch"></i></h4>
                      <div class="spinner-border text-danger spinner-timer"></div>
                      <span id="timer_left5" style="margin-bottom:0;"></span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
    
            <table class="table table-hover" style="margin-top:12px;">
              <thead>
                <tr>
                  <th>회차</th>
                  <th style="text-align:right;">시간</th>
                </tr>
              </thead>
              <tbody id='ttProvider5'>
              </tbody>
            </table>
          </div>

          <div id="tab6" class="container tab-pane">
              <div class="card bg-light text-dark text-center" style="margin-top:18px; margin-bottom:18px;">
                <div class="card-body">
                  <div class="container">
                    <div class="row" style="font-size:24px;">
                      <div class="col-4">
                        <h4 data-toggle="tooltip" data-placement="top" title="현재 시각"><i class="far fa-clock"></i></h4>
                        <div class="spinner-border text-danger spinner-timer"></div>
                        <span class="current_timer" style="margin-bottom:0;"></span>
                      </div>
                      <div class="col-4">
                        <h4 data-toggle="tooltip" data-placement="top" title="다음 버스 시각"><i class="fas fa-bus"></i></h4>
                        <div class="spinner-border text-danger spinner-timer"></div>
                        <span id="timer_nextbus6" style="margin-bottom:0;"></span>
                      </div>
                      <div class="col-4" style="color:dodgerblue;">
                        <h4 data-toggle="tooltip" data-placement="top" title="남은 시간"><i class="fas fa-stopwatch"></i></h4>
                        <div class="spinner-border text-danger spinner-timer"></div>
                        <span id="timer_left6" style="margin-bottom:0;"></span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
      
              <table class="table table-hover" style="margin-top:12px;">
                <thead>
                  <tr>
                    <th>회차</th>
                    <th style="text-align:right;">시간</th>
                  </tr>
                </thead>
                <tbody id='ttProvider6'>
                </tbody>
              </table>
            </div>

      
    </div>


  </div>

  <footer style="background-color:#3e2723; color:white;">
    <div class="container" style="padding-top:12px; padding-bottom:12px;">
      <span class="float-right"><a href="#" style="color:#fdd835;">Back to top</a></span>
      <span style="color:white">Work In Progress</span>
    </div>
  </footer>
</body>

</html>